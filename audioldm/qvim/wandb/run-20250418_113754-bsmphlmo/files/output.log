Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Validation DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:43<00:00,  2.72it/s]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     Validate metric           DataLoader 0
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        val/loss             2.304413318634033
         val/mrr            0.11452038586139679
        val/ndcg            0.25151342153549194
         val/tau            0.0700000748038292
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name              | Type           | Params | Mode
-------------------------------------------------------------
0 | mel               | AugmentMelSTFT | 0      | train
1 | imitation_encoder | MobileNetV3    | 4.9 M  | train
2 | reference_encoder | MobileNetV3    | 4.9 M  | train
  | other params      | n/a            | 1      | n/a
-------------------------------------------------------------
9.8 M     Trainable params
1         Non-trainable params
9.8 M     Total params
39.015    Total estimated model params size (MB)
531       Modules in train mode
0         Modules in eval mode
Epoch 6:  34%|███████████████████████████████████████████████████████████▏                                                                                                                | 228/662 [01:02<01:58,  3.66it/s, v_num=hlmo, train/loss=0.541, lr=0.000243, val/loss=0.815, val/mrr=0.363, val/ndcg=0.491]
                                                                                                                                                                                                                                                                                                                      
Metric val/loss improved. New best score: 1.214
Epoch 0, global step 662: 'val/loss' reached 1.21434 (best 1.21434), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-loss-checkpoint.ckpt' as top 1
Epoch 0, global step 662: 'val/mrr' reached 0.25673 (best 0.25673), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-mrr-checkpoint.ckpt' as top 1
Metric val/loss improved by 0.211 >= min_delta = 0.0. New best score: 1.003
Epoch 1, global step 1324: 'val/loss' reached 1.00314 (best 1.00314), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-loss-checkpoint.ckpt' as top 1
Epoch 1, global step 1324: 'val/mrr' reached 0.30648 (best 0.30648), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-mrr-checkpoint.ckpt' as top 1
Metric val/loss improved by 0.044 >= min_delta = 0.0. New best score: 0.959
Epoch 2, global step 1986: 'val/loss' reached 0.95905 (best 0.95905), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-loss-checkpoint.ckpt' as top 1
Epoch 2, global step 1986: 'val/mrr' reached 0.31466 (best 0.31466), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-mrr-checkpoint.ckpt' as top 1
Metric val/loss improved by 0.078 >= min_delta = 0.0. New best score: 0.881
Epoch 3, global step 2648: 'val/loss' reached 0.88099 (best 0.88099), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-loss-checkpoint.ckpt' as top 1
Epoch 3, global step 2648: 'val/mrr' reached 0.35378 (best 0.35378), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-mrr-checkpoint.ckpt' as top 1
Metric val/loss improved by 0.030 >= min_delta = 0.0. New best score: 0.851
Epoch 4, global step 3310: 'val/loss' reached 0.85083 (best 0.85083), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-loss-checkpoint.ckpt' as top 1
Epoch 4, global step 3310: 'val/mrr' was not in top 1
Metric val/loss improved by 0.036 >= min_delta = 0.0. New best score: 0.815
Epoch 5, global step 3972: 'val/loss' reached 0.81526 (best 0.81526), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-loss-checkpoint.ckpt' as top 1
Epoch 5, global step 3972: 'val/mrr' reached 0.36347 (best 0.36347), saving model to '/mnt/c/Users/Davy/Documents/Code/QM/qvim-baseline/models_vimsketch_longer/spring-armadillo-33/best-mrr-checkpoint.ckpt' as top 1
