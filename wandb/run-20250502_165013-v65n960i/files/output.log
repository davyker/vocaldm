Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Validation DataLoader 0:   0%|                                                                                                                                                                                                           | 0/30 [00:00<?, ?it/s]
[VALIDATION] Batch 0 - Processing validation data
[VALIDATION] Imitation shape: torch.Size([64, 320000]), Reference shape: torch.Size([64, 320000])
[VALIDATION] Imitation: min=-1.2777, max=1.2719
[VALIDATION] Reference: min=-1.0533, max=1.0435
[CLAP PIPELINE] Input audio shape: torch.Size([64, 320000])
[CLAP PIPELINE] Input audio stats: min=-1.0533, max=1.0435, mean=-0.0003, std=0.1575
[CLAP PIPELINE] After resampling: shape=torch.Size([64, 160000])
[CLAP PIPELINE] After resampling stats: min=-1.0732, max=1.0781, mean=-0.0003, std=0.1562
[CLAP PIPELINE] Processing 64 samples individually
[CLAP PIPELINE] Removed 0 trailing zeros from sample 0
[CLAP PIPELINE] Sample 0 shape: torch.Size([1, 160000])
[CLAP PIPELINE] Sample 0: 9998/160000 near-zero values
[DEBUG MEL] Input audio_data shape: torch.Size([480000])
[DEBUG MEL] Input audio stats: min=-0.9736, max=1.0039, mean=-0.0001
[DEBUG MEL] Using audio_cfg: sr=48000, n_fft=1024, hop=480
[DEBUG MEL] Pre-log mel: shape=torch.Size([64, 1001]), NaNs=0, Infs=0, Zeros=1079
[DEBUG MEL] Pre-log mel stats: min=0.00000000, max=18576.00000000
[DEBUG MEL] Post-log mel: NaNs=0, Infs=0
[DEBUG MEL] Post-log mel stats: min=-37.31, max=42.69
[CLAP PIPELINE] Removed 150951 trailing zeros from sample 1
[DEBUG MEL] Input audio_data shape: torch.Size([480000])
[DEBUG MEL] Input audio stats: min=-0.9624, max=1.0107, mean=-0.0003
[DEBUG MEL] Using audio_cfg: sr=48000, n_fft=1024, hop=480
[DEBUG MEL] Pre-log mel: shape=torch.Size([64, 1001]), NaNs=0, Infs=0, Zeros=8395
[DEBUG MEL] Pre-log mel stats: min=0.00000000, max=13344.00000000
[DEBUG MEL] Post-log mel: NaNs=0, Infs=0
[DEBUG MEL] Post-log mel stats: min=-38.75, max=41.25
[CLAP PIPELINE] Removed 50916 trailing zeros from sample 2
[DEBUG MEL] Input audio_data shape: torch.Size([480000])
[DEBUG MEL] Input audio stats: min=-0.9678, max=0.9644, mean=-0.0000
[DEBUG MEL] Using audio_cfg: sr=48000, n_fft=1024, hop=480
[DEBUG MEL] Pre-log mel: shape=torch.Size([64, 1001]), NaNs=0, Infs=0, Zeros=22764
[DEBUG MEL] Pre-log mel stats: min=0.00000000, max=32992.00000000
[DEBUG MEL] Post-log mel: NaNs=0, Infs=0
[DEBUG MEL] Post-log mel stats: min=-34.82, max=45.18
[CLAP PIPELINE] Removed 39821 trailing zeros from sample 3
[DEBUG MEL] Input audio_data shape: torch.Size([480000])
[DEBUG MEL] Input audio stats: min=-0.7939, max=0.9995, mean=-0.0000
[DEBUG MEL] Using audio_cfg: sr=48000, n_fft=1024, hop=480
[DEBUG MEL] Pre-log mel: shape=torch.Size([64, 1001]), NaNs=0, Infs=0, Zeros=16289
[DEBUG MEL] Pre-log mel stats: min=0.00000000, max=15952.00000000
[DEBUG MEL] Post-log mel: NaNs=0, Infs=0
[DEBUG MEL] Post-log mel stats: min=-37.97, max=42.03
[CLAP PIPELINE] Removed 63824 trailing zeros from sample 4
[DEBUG MEL] Input audio_data shape: torch.Size([480000])
[DEBUG MEL] Input audio stats: min=-0.9976, max=0.9971, mean=0.0246
[DEBUG MEL] Using audio_cfg: sr=48000, n_fft=1024, hop=480
[DEBUG MEL] Pre-log mel: shape=torch.Size([64, 1001]), NaNs=0, Infs=0, Zeros=25476
[DEBUG MEL] Pre-log mel stats: min=0.00000000, max=15472.00000000
[DEBUG MEL] Post-log mel: NaNs=0, Infs=0
[DEBUG MEL] Post-log mel stats: min=-38.10, max=41.90

Detected KeyboardInterrupt, attempting graceful shutdown ...
