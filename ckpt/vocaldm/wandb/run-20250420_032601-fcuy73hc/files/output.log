Saving checkpoints to run-specific directory: ckpt/vocaldm/amber-serenity-74
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
`Trainer(val_check_interval=1.0)` was configured so validation will run at the end of the training epoch..

===== Running initial validation for baseline metrics =====
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Validation DataLoader 0:   0%|                                                                                                                                                                                           | 0/312 [00:00<?, ?it/s]Audio logging disabled (use --log_audio to enable)
DDIM Sampler: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:18<00:00,  2.70it/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:18<00:00,  3.93it/s]
Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 312/312 [05:55<00:00,  0.88it/s]
Saved improved adapter to ckpt/vocaldm/qvim_adapter_val_loss_0.6843.pt
Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 312/312 [05:56<00:00,  0.88it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m [0m[1m     Validate metric     [0m[1m [0m┃[1m [0m[1m      DataLoader 0       [0m[1m [0m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m [0m[36m     val/cosine_loss     [0m[36m [0m│[35m [0m[35m           0.0           [0m[35m [0m│
│[36m [0m[36m     val/epoch_loss      [0m[36m [0m│[35m [0m[35m   0.6850054860115051    [0m[35m [0m│
│[36m [0m[36m        val/loss         [0m[36m [0m│[35m [0m[35m   0.6842516660690308    [0m[35m [0m│
│[36m [0m[36m      val/mse_loss       [0m[36m [0m│[35m [0m[35m   0.6842516660690308    [0m[35m [0m│
│[36m [0m[36m        val_loss         [0m[36m [0m│[35m [0m[35m   0.6842516660690308    [0m[35m [0m│
└───────────────────────────┴───────────────────────────┘
Initial validation loss: 0.684252
===== Initial validation complete =====

  | Name       | Type            | Params | Mode
-------------------------------------------------------
0 | qvim_model | QVIMModule      | 9.8 M  | eval
1 | adapter    | QVIMAdapter     | 1.5 M  | train
2 | audioldm   | LatentDiffusion | 726 M  | eval
-------------------------------------------------------
2.6 M     Trainable params
734 M     Non-trainable params
737 M     Total params
2,949.710 Total estimated model params size (MB)
12        Modules in train mode
2245      Modules in eval mode

Sanity Checking DataLoader 0:   0%|                                                                                                                                                                                      | 0/312 [00:00<?, ?it/s]Audio logging disabled (use --log_audio to enable)
DDIM Sampler: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:16<00:00,  2.96it/s]
DDIM Sampler: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:16<00:00,  2.89it/s]
Sanity Checking DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 312/312 [05:44<00:00,  0.91it/s]
Saved improved adapter to ckpt/vocaldm/qvim_adapter_val_loss_0.6644.pt
Epoch 0:   0%|                                                                                                                                                                                                          | 0/2802 [00:00<?, ?it/s]diffusion_loss requires_grad: True
Checking gradient paths:
Component requires_grad check: {'squared_diff': True, 'model_output': True, 'target': False}
Optimizer parameter groups:
  Group 0: lr=0.0001, 8 parameters
  Group 1: lr=1e-05, 6 parameters
Step 0 LRs - Adapter: 0.00010000, Film: 0.00001000
Epoch 0:   0%|                                                                                                                     | 1/2802 [00:03<2:55:32,  0.27it/s, v_num=73hc, train/loss=0.755, train/adapter_lr=0.0001, train/film_lr=1e-5]Optimizer parameter groups:
  Group 0: lr=0.0001, 8 parameters
  Group 1: lr=1e-05, 6 parameters
Step 0 LRs - Adapter: 0.00010000, Film: 0.00001000
Epoch 0:   0%|                                                                                                                     | 2/2802 [00:06<2:24:31,  0.32it/s, v_num=73hc, train/loss=0.520, train/adapter_lr=0.0001, train/film_lr=1e-5]Optimizer parameter groups:
  Group 0: lr=0.0001, 8 parameters
  Group 1: lr=1e-05, 6 parameters
Step 0 LRs - Adapter: 0.00010000, Film: 0.00001000
Epoch 0:   0%|▏                                                                                                                    | 3/2802 [00:08<2:06:59,  0.37it/s, v_num=73hc, train/loss=0.737, train/adapter_lr=0.0001, train/film_lr=1e-5]Optimizer parameter groups:
  Group 0: lr=0.0001, 8 parameters
  Group 1: lr=1e-05, 6 parameters
Step 0 LRs - Adapter: 0.00010000, Film: 0.00001000
Epoch 0:   4%|████▍                                                                                                              | 108/2802 [03:16<1:21:29,  0.55it/s, v_num=73hc, train/loss=0.824, train/adapter_lr=0.0001, train/film_lr=1e-5]Resources cleaned up
Detected KeyboardInterrupt, attempting graceful shutdown ...
