Saving checkpoints to run-specific directory: ckpt/vocaldm/fleqbe4j
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
`Trainer(val_check_interval=1.0)` was configured so validation will run at the end of the training epoch..

===== Running initial validation for baseline metrics =====
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Validation DataLoader 0:   0%|                                                                                                                                                                                             | 0/1 [00:00<?, ?it/s]Resampling audio from 32000Hz to 16000Hz
Resampled audio shape: torch.Size([160000])
Before reshaping, mel shape: torch.Size([1, 1, 64, 1001]), target: (1, 64, 64)
Error in waveform_to_mel: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 4 is not equal to len(dims) = 3
Falling back to placeholder method
DDIM Sampler: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:15<00:00,  3.25it/s]
Traceback (most recent call last):███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:15<00:00,  3.50it/s]
Error in audio logging: ushort format requires 0 <= number <= (0x7fff * 2 + 1)
  File "/mnt/c/Users/Davy/Documents/Code/QM/CC/AudioLDM/train_vocaldm.py", line 919, in log_audio_examples
    wavfile.write(generated_path, sample_rate, generated_audio_np.astype(np.float32))
  File "/root/miniconda3/envs/qvim-baseline/lib/python3.10/site-packages/scipy/io/wavfile.py", line 824, in write
    fmt_chunk_data = struct.pack('<HHIIHH', format_tag, channels, fs,
struct.error: ushort format requires 0 <= number <= (0x7fff * 2 + 1)
Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:19<00:00,  0.05it/s]
Saved improved adapter to ckpt/vocaldm/qvim_adapter_val_loss_0.2865.pt

Detected KeyboardInterrupt, attempting graceful shutdown ...
Resources cleaned up
